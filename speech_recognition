import speech_recognition as sr
from datetime import datetime

def record_note():
    recognizer = sr.Recognizer()
    with sr.Microphone() as source:
        print("\n🎤 Speak your note...")
        recognizer.adjust_for_ambient_noise(source)
        audio = recognizer.listen(source, timeout=5)

    try:
        note = recognizer.recognize_google(audio)
        print(f"📝 You said: {note}")
        return note
    except sr.UnknownValueError:
        print("🤷 Sorry, I couldn't understand.")
    except sr.RequestError as e:
        print(f"⚠️ Could not request results; {e}")
    return None

def save_note(note):
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    with open("notes.txt", "a", encoding="utf-8") as f:
        f.write(f"[{timestamp}] {note}\n")
    print("✅ Saved to notes.txt")

if __name__ == "__main__":
    print("📓 Voice Note App (Offline)")
    print("Press Ctrl+C to stop")

    try:
        while True:
            note = record_note()
            if note:
                save_note(note)
    except KeyboardInterrupt:
        print("\n👋 Exiting.")
